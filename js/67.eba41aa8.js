"use strict";(self.webpackChunkpuls=self.webpackChunkpuls||[]).push([[67],{9067:function(e,t,l){l.r(t),l.d(t,{default:function(){return b}});var o=l(311),r=l(1158),a=l(7467),n=l.n(a),i=l(1020);const c=(0,i.Q_)("loca",{state:()=>({config:{}}),persist:!0,actions:{},getters:{}});(0,i.Q_)("xxx",{state:()=>({query:{},mt:{}}),persist:{storage:sessionStorage}});let d=c();const s=n().create({baseURL:"http://"+(d.config.api||"127.0.0.1")+":3000/api",timeout:5e3});s.interceptors.request.use((e=>{let t=p("token");return e.headers["x-token"]=t,e}),(e=>(r.ElMessage.error("拦截器异常"),Promise.reject(e)))),s.interceptors.response.use((e=>0===e.data.code?e.data.data:(r.ElMessage.error(e.data.msg),Promise.reject(e))),(e=>(r.ElMessage.error(e),Promise.reject(e))));const u=e=>{let{url:t,params:l,data:o,loading:r=!0}=e;return s({url:t,method:o?"post":"get",params:l,data:o})};let p=e=>{if(document.cookie.length>0){var t=document.cookie.indexOf(e+"=");if(-1!==t){t=t+e.length+1;var l=document.cookie.indexOf(";",t);return-1===l&&(l=document.cookie.length),unescape(document.cookie.substring(t,l))}}return localStorage.getItem(e)};const m=e=>u({url:"Openlog",params:e}),f=e=>u({url:"Open",params:e}),w={class:"box-main"},V={class:"f-",style:{margin:"0px 0px 10px"}},h={class:"gva-table-box"},g={class:"fs12",style:{color:"red"}},N={class:"fs12",style:{color:"red"}},x={class:"fs12",style:{color:"red"}},y={class:"fs12",style:{color:"red"}},C={class:"mt20"},v={class:"dialog-footer"},k={key:0,class:"f1",style:{"justify-content":"space-between"}},E={class:"mt20"};var _={__name:"index",setup(e){let t=c(),l=(0,o.ref)(),a=(0,o.ref)([]),n=(0,o.ref)(!1),i=(0,o.ref)(),d=t.config;function s(){let e=l.value.getSelectionRows().map((e=>e.Uid));var t;(t={list:e,data:d},u({url:"start",data:t})).then((e=>{})),r.ElMessage.success("启动成功")}function p(){let e=l.value.getSelectionRows().map((e=>e.Uid));u({url:"stop",data:{list:e}}),r.ElMessage.success("脚本已停止")}function _(){let e=[];return a.value.forEach((t=>{let l=t.Group;e.push(l)})),[...new Set([...e])].map((e=>({text:e+"组",value:e})))}(0,o.onMounted)((async()=>{let{list:e,id:t,authorized:l,total:o}=await u({url:"DeviceList",params:r});var r;a.value=e,d.id=t,d.total=o,d.authorized=l}));const b=(e,t,o)=>{const r=o.property;return l.value.clearSelection(),t[r]===e};function S(e){let t=JSON.parse(e);return"".concat(t.query," (").concat(t.country,"-").concat(t.city,")")}return(e,t)=>{const c=(0,o.resolveComponent)("el-table-column"),u=(0,o.resolveComponent)("el-tag"),B=(0,o.resolveComponent)("el-button"),U=(0,o.resolveComponent)("el-table"),D=(0,o.resolveComponent)("el-input"),T=(0,o.resolveComponent)("el-form-item"),R=(0,o.resolveComponent)("el-option"),I=(0,o.resolveComponent)("el-select"),M=(0,o.resolveComponent)("el-switch"),F=(0,o.resolveComponent)("el-form"),L=(0,o.resolveComponent)("el-dialog"),O=(0,o.resolveComponent)("el-image"),z=(0,o.resolveComponent)("el-timeline-item"),j=(0,o.resolveComponent)("el-timeline");return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[(0,o.createElementVNode)("div",w,[(0,o.createElementVNode)("div",V,[(0,o.createElementVNode)("span",null,"已连接："+(0,o.toDisplayString)((0,o.unref)(a).length),1),(0,o.createElementVNode)("span",null,"总收益："+(0,o.toDisplayString)((0,o.unref)(d).total),1),(0,o.createElementVNode)("span",null,"授权数量："+(0,o.toDisplayString)((0,o.unref)(d).authorized),1),(0,o.createElementVNode)("span",null,"设备码："+(0,o.toDisplayString)((0,o.unref)(d).id),1)]),(0,o.createElementVNode)("div",h,[(0,o.createVNode)(U,{ref_key:"Table",ref:l,style:{width:"100%",color:"#000"},"max-height":700,"tooltip-effect":"dark",data:(0,o.unref)(a),"highlight-current-row":!0,border:"","row-class-name":e=>{let{row:t,rowIndex:l}=e;return t.State?"warning-row":"success-row"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{type:"selection"}),(0,o.createVNode)(c,{label:"分组",property:"Group",filters:_(),width:"80","filter-method":b,"filter-multiple":!1},{default:(0,o.withCtx)((e=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.row.Group)+"/"+(0,o.toDisplayString)(e.row.Identifier),1)])),_:1},8,["filters"]),(0,o.createVNode)(c,{label:"连接状态",property:"Errs","filter-multiple":!1,filters:[{text:"在线",value:!1},{text:"离线",value:!0}],width:"100","filter-method":b},{default:(0,o.withCtx)((e=>[(0,o.createVNode)(u,{effect:"dark","disable-transitions":"",type:e.row.Errs?"danger":"success"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.row.Errs?"离线":"在线"),1)])),_:2},1032,["type"])])),_:1}),(0,o.createVNode)(c,{label:"工作状态",property:"State","filter-multiple":!1,filters:[{text:"空闲",value:!1},{text:"工作中",value:!0}],width:"100","filter-method":b},{default:(0,o.withCtx)((e=>[(0,o.createVNode)(u,{effect:"dark","disable-transitions":"",type:e.row.State?"danger":"success"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.row.State?"工作中":"空闲"),1)])),_:2},1032,["type"])])),_:1}),(0,o.createVNode)(c,{label:"成功","show-overflow-tooltip":!0,width:"80",align:"center"},{default:(0,o.withCtx)((e=>[(0,o.createElementVNode)("div",g,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(e.row.Income,((e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)("span",{key:t},(0,o.toDisplayString)(e.success)+"-",1)))),128))])])),_:1}),(0,o.createVNode)(c,{label:"失败","show-overflow-tooltip":!0,width:"80",align:"center"},{default:(0,o.withCtx)((e=>[(0,o.createElementVNode)("div",N,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(e.row.Income,((e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)("span",{key:t},(0,o.toDisplayString)(e.fail)+"-",1)))),128))])])),_:1}),(0,o.createVNode)(c,{label:"收益","show-overflow-tooltip":!0,width:"80",align:"center"},{default:(0,o.withCtx)((e=>[(0,o.createElementVNode)("div",x,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(e.row.Income,((e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)("span",{key:t},(0,o.toDisplayString)(e.amount)+"-",1)))),128))])])),_:1}),(0,o.createVNode)(c,{label:"设备信息","show-overflow-tooltip":!0},{default:(0,o.withCtx)((e=>[(0,o.createElementVNode)("div",y,[(0,o.createElementVNode)("span",null," CID: "+(0,o.toDisplayString)(e.row.Cid),1),(0,o.createElementVNode)("span",null," 局域网: "+(0,o.toDisplayString)(e.row.Ip),1),(0,o.createElementVNode)("span",null," 外网: "+(0,o.toDisplayString)(S(e.row.Ips)),1),(0,o.createElementVNode)("span",null," ID: "+(0,o.toDisplayString)(e.row.Uid),1)])])),_:1}),(0,o.createVNode)(c,{label:"操作",width:"200"},{default:(0,o.withCtx)((e=>[(0,o.createVNode)(B,{type:"primary",link:"",onClick:t=>(0,o.unref)(m)({Uid:e.row.Uid}).then((t=>(0,o.isRef)(i)?i.value={list:t.list,image:t.image,Uid:e.row.Uid}:i={list:t.list,image:t.image,Uid:e.row.Uid}))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("工作状态")])),_:2},1032,["onClick"]),(0,o.createVNode)(B,{type:"primary",link:"",onClick:t=>(0,o.unref)(f)({Uid:e.row.Uid})},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("重启设备")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","row-class-name"]),(0,o.createElementVNode)("div",C,[(0,o.createVNode)(B,{type:"primary",onClick:t[0]||(t[0]=e=>(0,o.unref)(l).toggleAllSelection())},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("全选/取消")])),_:1}),(0,o.createVNode)(B,{type:"primary",onClick:t[1]||(t[1]=e=>((0,o.unref)(l).clearFilter(),(0,o.unref)(l).clearSelection()))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("重置选择")])),_:1}),(0,o.createVNode)(B,{type:"primary",onClick:t[2]||(t[2]=e=>(0,o.unref)(l).getSelectionRows().length?s():(0,o.unref)(r.ElMessage).error("请选择要操作的设备"))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("启动脚本")])),_:1}),(0,o.createVNode)(B,{type:"danger",onClick:t[3]||(t[3]=e=>(0,o.unref)(l).getSelectionRows().length?p():(0,o.unref)(r.ElMessage).error("请选择要操作的设备"))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("停止脚本")])),_:1}),(0,o.createVNode)(B,{type:"primary",onClick:t[4]||(t[4]=e=>(0,o.isRef)(n)?n.value=!0:n=!0)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("脚本配置")])),_:1}),(0,o.createVNode)(B,{type:"primary",onClick:t[5]||(t[5]=e=>(0,o.unref)(l).getSelectionRows().length?p():(0,o.unref)(r.ElMessage).error("请选择要操作的设备"))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("重启设备")])),_:1})])])]),(0,o.createVNode)(L,{modelValue:(0,o.unref)(n),"onUpdate:modelValue":t[13]||(t[13]=e=>(0,o.isRef)(n)?n.value=e:n=e),title:"脚本配置信息",width:"30%",center:""},{footer:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",v,[(0,o.createVNode)(B,{type:"primary",onClick:t[12]||(t[12]=e=>(0,o.isRef)(n)?n.value=!1:n=!1),style:{width:"50%",height:"40px"}},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("保存配置")])),_:1})])])),default:(0,o.withCtx)((()=>[(0,o.createVNode)(F,{"label-width":"100px",model:(0,o.unref)(d),"label-position":"left"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(T,{label:"脚本服务端"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(D,{modelValue:(0,o.unref)(d).api,"onUpdate:modelValue":t[6]||(t[6]=e=>(0,o.unref)(d).api=e),placeholder:"默认本机ip地址",style:{width:"80%"}},null,8,["modelValue"])])),_:1}),(0,o.createVNode)(T,{label:"OCR服务端"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(D,{modelValue:(0,o.unref)(d).ocr,"onUpdate:modelValue":t[7]||(t[7]=e=>(0,o.unref)(d).ocr=e),placeholder:"默认本机ip地址",style:{width:"80%"}},null,8,["modelValue"])])),_:1}),(0,o.createVNode)(T,{label:"选择脚本"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(I,{modelValue:(0,o.unref)(d).step,"onUpdate:modelValue":t[8]||(t[8]=e=>(0,o.unref)(d).step=e),placeholder:"点击选择"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(R,{label:"养号+抢宝",value:"0"}),(0,o.createVNode)(R,{label:"养号",value:"10"})])),_:1},8,["modelValue"])])),_:1}),(0,o.createVNode)(T,{label:"是否检测代理"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(M,{modelValue:(0,o.unref)(d).agent,"onUpdate:modelValue":t[9]||(t[9]=e=>(0,o.unref)(d).agent=e)},null,8,["modelValue"])])),_:1}),(0,o.createVNode)(T,{label:"养号间隔:"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(D,{modelValue:(0,o.unref)(d).develop,"onUpdate:modelValue":t[10]||(t[10]=e=>(0,o.unref)(d).develop=e),placeholder:"分钟计算单位",style:{width:"50%","margin-right":"10px"}},null,8,["modelValue"]),(0,o.createTextVNode)("分 ")])),_:1}),(0,o.createVNode)(T,{label:"切换间隔:"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(D,{modelValue:(0,o.unref)(d).switch,"onUpdate:modelValue":t[11]||(t[11]=e=>(0,o.unref)(d).switch=e),placeholder:"分钟计算单位",style:{width:"50%","margin-right":"10px"}},null,8,["modelValue"]),(0,o.createTextVNode)("分 ")])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,o.createVNode)(L,{modelValue:(0,o.unref)(i),"onUpdate:modelValue":t[14]||(t[14]=e=>(0,o.isRef)(i)?i.value=e:i=e),title:"工作状态",width:"20%",center:""},{default:(0,o.withCtx)((()=>[(0,o.unref)(i)?((0,o.openBlock)(),(0,o.createElementBlock)("div",k,[(0,o.createVNode)(O,{style:{width:"50%"},src:"".concat((0,o.unref)(i).image),"zoom-rate":1.2,"preview-src-list":["".concat((0,o.unref)(i).image)],"initial-index":4,fit:"cover"},null,8,["src","zoom-rate","preview-src-list"])])):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("div",E,[(0,o.createVNode)(j,null,{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(i).list,((e,t)=>((0,o.openBlock)(),(0,o.createBlock)(z,{key:t,timestamp:e.time},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.content),1)])),_:2},1032,["timestamp"])))),128))])),_:1})])])),_:1},8,["modelValue"])],64)}}};var b=(0,l(89).Z)(_,[["__scopeId","data-v-580e5e4e"]])}}]);