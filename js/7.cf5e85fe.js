"use strict";(self.webpackChunkpuls=self.webpackChunkpuls||[]).push([[7],{8007:function(e,t,o){o.r(t),o.d(t,{default:function(){return _}});var r=o(311),l=o(1158),n=o(7467),a=o.n(n),i=o(1020);const c=(0,i.Q_)("loca",{state:()=>({config:{}}),persist:!0,actions:{},getters:{}});(0,i.Q_)("xxx",{state:()=>({query:{},mt:{}}),persist:{storage:sessionStorage}});let s=c();const d=a().create({baseURL:"http://"+(s.config.api||"127.0.0.1")+":3000/api",timeout:5e3});d.interceptors.request.use((e=>{let t=f("token");return e.headers["x-token"]=t,e}),(e=>(l.ElMessage.error("拦截器异常"),Promise.reject(e)))),d.interceptors.response.use((e=>0===e.data.code?e.data.data:(l.ElMessage.error(e.data.msg),Promise.reject(e))),(e=>(l.ElMessage.error(e),Promise.reject(e))));const u=e=>{let{url:t,params:o,data:r,loading:l=!0}=e;return d({url:t,method:r?"post":"get",params:o,data:r})};let f=e=>{if(document.cookie.length>0){var t=document.cookie.indexOf(e+"=");if(-1!==t){t=t+e.length+1;var o=document.cookie.indexOf(";",t);return-1===o&&(o=document.cookie.length),unescape(document.cookie.substring(t,o))}}return localStorage.getItem(e)};const p=e=>u({url:"Openlog",params:e}),m=e=>u({url:"resetting",params:e});function w(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function g(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const h={class:"box-main"},V={class:"f-",style:{margin:"0px 0px 10px"}},y={class:"gva-table-box"},v={class:"fs12",style:{color:"#409eff"}},N={class:"fs12"},x={class:"fs12",style:{color:"red"}},b={class:"mt20"},C={class:"dialog-footer"},k={key:0,class:"f1",style:{"justify-content":"space-between"}},E={class:"mt20"};var S={__name:"index",setup(e){let t=c(),o=(0,r.ref)(),n=(0,r.ref)([]),a=(0,r.ref)(!1),i=(0,r.ref)(),s=t.config,d=(0,r.reactive)({});function f(){(e=>u({url:"start",data:e}))({list:o.value.getSelectionRows().map((e=>e.Inof.Uid)),data:s}).then((e=>{})),l.ElMessage.success("启动成功")}function S(){(e=>{u({url:"stop",data:e})})({list:o.value.getSelectionRows().map((e=>e.Inof.Uid))}),l.ElMessage.success("脚本已停止")}function _(){let e=[];for(let t=0;t<20;t++)e.push({text:t+"组",value:t});return e}(0,r.onMounted)((async()=>{var e;d=await u({url:"DeviceList",params:e}),n.value=d.list.map((e=>(e.Inof.Group=e.Inof.Group?e.Inof.Group:"99",e.Inof.Identifier=e.Inof.Identifier?e.Inof.Identifier:"99",function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?w(Object(o),!0).forEach((function(t){g(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):w(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({},e)))),await(0,r.nextTick)(),o.value.sort("Group","ascending")}));const I=(e,t,r)=>{const l=r.property;return o.value.clearSelection(),t[l]===e};function D(e){if("null"==e||""==e)return"未获取到";let t=e;return t.query?"".concat(t.query," (").concat(t.country,"-").concat(t.city,")"):"未获取到"}function B(e){if(0==e)return"";const t=Math.floor(Date.now()/1e3)-e,o=Math.floor(t/3600),r=Math.floor(t%3600/60),l=t%60;return"".concat(o,"时").concat(r,"分").concat(l)}return(e,t)=>{const c=(0,r.resolveComponent)("el-table-column"),u=(0,r.resolveComponent)("el-tag"),w=(0,r.resolveComponent)("el-button"),g=(0,r.resolveComponent)("el-table"),O=(0,r.resolveComponent)("el-input"),j=(0,r.resolveComponent)("el-form-item"),T=(0,r.resolveComponent)("el-option"),U=(0,r.resolveComponent)("el-select"),P=(0,r.resolveComponent)("el-switch"),M=(0,r.resolveComponent)("el-form"),L=(0,r.resolveComponent)("el-dialog"),R=(0,r.resolveComponent)("el-image"),A=(0,r.resolveComponent)("el-timeline-item"),F=(0,r.resolveComponent)("el-timeline");return(0,r.openBlock)(),(0,r.createElementBlock)(r.Fragment,null,[(0,r.createElementVNode)("div",h,[(0,r.createElementVNode)("div",V,[(0,r.createElementVNode)("span",null,"已连接："+(0,r.toDisplayString)((0,r.unref)(n).length),1),(0,r.createElementVNode)("span",null,"今日收益："+(0,r.toDisplayString)((0,r.unref)(d).deyincome),1),(0,r.createElementVNode)("span",null,"总收益："+(0,r.toDisplayString)((0,r.unref)(d).todayincome),1),(0,r.createElementVNode)("span",null,"总余额："+(0,r.toDisplayString)((0,r.unref)(d).totalBalance),1),(0,r.createElementVNode)("span",null,"授权数量："+(0,r.toDisplayString)((0,r.unref)(d).Authorized),1),(0,r.createElementVNode)("span",null,"设备码："+(0,r.toDisplayString)((0,r.unref)(d).ID),1)]),(0,r.createElementVNode)("div",y,[(0,r.createVNode)(g,{ref_key:"Table",ref:o,style:{width:"100%",color:"#000"},"max-height":700,"tooltip-effect":"dark",data:(0,r.unref)(n),"highlight-current-row":!0,border:"","row-class-name":e=>{let{row:t,rowIndex:o}=e;return t.Inof.State?"warning-row":"success-row"}},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(c,{type:"selection"}),(0,r.createVNode)(c,{label:"分组",property:"Group",width:"80",filters:_(),"filter-method":I,"filter-multiple":!1,align:"center"},{default:(0,r.withCtx)((e=>[(0,r.createTextVNode)((0,r.toDisplayString)(e.row.Inof.Group)+"/"+(0,r.toDisplayString)(e.row.Inof.Identifier),1)])),_:1},8,["filters"]),(0,r.createVNode)(c,{label:"连接状态",property:"Errs","filter-multiple":!1,filters:[{text:"在线",value:!1},{text:"离线",value:!0}],width:"100","filter-method":I,align:"center"},{default:(0,r.withCtx)((e=>[(0,r.createVNode)(u,{effect:"dark","disable-transitions":"",type:e.row.Inof.Errs?"danger":"success"},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)((0,r.toDisplayString)(e.row.Inof.Errs?"离线":"在线"),1)])),_:2},1032,["type"])])),_:1}),(0,r.createVNode)(c,{label:"工作状态",property:"State","filter-multiple":!1,filters:[{text:"空闲",value:!1},{text:"工作中",value:!0}],width:"100","filter-method":I,align:"center"},{default:(0,r.withCtx)((e=>[(0,r.createVNode)(u,{effect:"dark","disable-transitions":"",type:e.row.Inof.State?"danger":"success"},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)((0,r.toDisplayString)(e.row.Inof.State?"工作中":"空闲"),1)])),_:2},1032,["type"])])),_:1}),(0,r.createVNode)(c,{label:"当前任务",property:"WorLog",width:"120","show-overflow-tooltip":!0,align:"center"},{default:(0,r.withCtx)((e=>[(0,r.createElementVNode)("div",v,(0,r.toDisplayString)(e.row.Inof.WorLog?e.row.Inof.WorLog[0].content:""),1)])),_:1}),(0,r.createVNode)(c,{label:"已运行","show-overflow-tooltip":!0,width:"100",align:"center"},{default:(0,r.withCtx)((e=>[(0,r.createElementVNode)("div",N,(0,r.toDisplayString)(B(e.row.Inof.WorTime)),1)])),_:1}),(0,r.createVNode)(c,{label:"成功","show-overflow-tooltip":!0,width:"80",align:"center"},{default:(0,r.withCtx)((e=>[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(e.row.Accounts,((e,t)=>((0,r.openBlock)(),(0,r.createElementBlock)("span",{class:"fd fs12",style:{color:"red"},key:t},(0,r.toDisplayString)(e.Success),1)))),128))])),_:1}),(0,r.createVNode)(c,{label:"失败","show-overflow-tooltip":!0,width:"80",align:"center"},{default:(0,r.withCtx)((e=>[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(e.row.Accounts,((e,t)=>((0,r.openBlock)(),(0,r.createElementBlock)("span",{class:"fd fs12",style:{color:"red"},key:t},(0,r.toDisplayString)(e.Fail),1)))),128))])),_:1}),(0,r.createVNode)(c,{label:"收益","show-overflow-tooltip":!0,width:"80",align:"center"},{default:(0,r.withCtx)((e=>[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(e.row.Accounts,((e,t)=>((0,r.openBlock)(),(0,r.createElementBlock)("span",{class:"fd fs12",style:{color:"red"},key:t},(0,r.toDisplayString)(e.Income),1)))),128))])),_:1}),(0,r.createVNode)(c,{label:"余额","show-overflow-tooltip":!0,width:"80",align:"center"},{default:(0,r.withCtx)((e=>[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(e.row.Accounts,((e,t)=>((0,r.openBlock)(),(0,r.createElementBlock)("span",{class:"fd fs12",style:{color:"red"},key:t},(0,r.toDisplayString)(e.Balance),1)))),128))])),_:1}),(0,r.createVNode)(c,{label:"设备信息","show-overflow-tooltip":!0,align:"center"},{default:(0,r.withCtx)((e=>[(0,r.createElementVNode)("div",x,[(0,r.createElementVNode)("span",null,"账号数量："+(0,r.toDisplayString)(e.row.Accounts.length),1),(0,r.createElementVNode)("span",null," 局域网: "+(0,r.toDisplayString)(e.row.Inof.Ip),1),(0,r.createElementVNode)("span",null," 外网: "+(0,r.toDisplayString)(D(e.row.Inof.Ips)),1),(0,r.createElementVNode)("span",null," ID: "+(0,r.toDisplayString)(e.row.Inof.Uid),1)])])),_:1}),(0,r.createVNode)(c,{label:"操作",width:"100",align:"center"},{default:(0,r.withCtx)((e=>[(0,r.createVNode)(w,{type:"primary",link:"",onClick:t=>(0,r.unref)(p)({Uid:e.row.Inof.Uid}).then((t=>(0,r.isRef)(i)?i.value={list:t.list,image:t.image,Uid:e.row.Uid}:i={list:t.list,image:t.image,Uid:e.row.Uid}))},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)("工作状态")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","row-class-name"]),(0,r.createElementVNode)("div",b,[(0,r.createVNode)(w,{type:"primary",onClick:t[0]||(t[0]=e=>(0,r.unref)(o).toggleAllSelection())},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)("全选/取消")])),_:1}),(0,r.createVNode)(w,{type:"primary",onClick:t[1]||(t[1]=e=>(0,r.unref)(o).getSelectionRows().length?f():(0,r.unref)(l.ElMessage).error("请选择要操作的设备"))},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)("启动脚本")])),_:1}),(0,r.createVNode)(w,{type:"danger",onClick:t[2]||(t[2]=e=>(0,r.unref)(o).getSelectionRows().length?S():(0,r.unref)(l.ElMessage).error("请选择要操作的设备"))},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)("停止脚本")])),_:1}),(0,r.createVNode)(w,{type:"primary",onClick:t[3]||(t[3]=e=>(0,r.isRef)(a)?a.value=!0:a=!0)},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)("脚本配置")])),_:1}),(0,r.createVNode)(w,{type:"primary",onClick:t[4]||(t[4]=e=>((0,r.unref)(m)(),(0,r.unref)(l.ElMessage).success("重置完成")))},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)("重置数据")])),_:1})])])]),(0,r.createVNode)(L,{modelValue:(0,r.unref)(a),"onUpdate:modelValue":t[11]||(t[11]=e=>(0,r.isRef)(a)?a.value=e:a=e),title:"脚本配置信息",width:"30%",center:""},{footer:(0,r.withCtx)((()=>[(0,r.createElementVNode)("span",C,[(0,r.createVNode)(w,{type:"primary",onClick:t[10]||(t[10]=e=>(0,r.isRef)(a)?a.value=!1:a=!1),style:{width:"50%",height:"40px"}},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)("保存配置")])),_:1})])])),default:(0,r.withCtx)((()=>[(0,r.createVNode)(M,{"label-width":"100px",model:(0,r.unref)(s),"label-position":"left"},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(j,{label:"脚本服务端"},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(O,{modelValue:(0,r.unref)(s).api,"onUpdate:modelValue":t[5]||(t[5]=e=>(0,r.unref)(s).api=e),placeholder:"默认本机ip地址",style:{width:"80%"}},null,8,["modelValue"])])),_:1}),(0,r.createVNode)(j,{label:"选择脚本"},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(U,{modelValue:(0,r.unref)(s).step,"onUpdate:modelValue":t[6]||(t[6]=e=>(0,r.unref)(s).step=e),placeholder:"点击选择"},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(T,{label:"养号+抢宝",value:"0"}),(0,r.createVNode)(T,{label:"养号",value:"10"})])),_:1},8,["modelValue"])])),_:1}),(0,r.createVNode)(j,{label:"是否检测代理"},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(P,{modelValue:(0,r.unref)(s).agent,"onUpdate:modelValue":t[7]||(t[7]=e=>(0,r.unref)(s).agent=e)},null,8,["modelValue"])])),_:1}),(0,r.createVNode)(j,{label:"养号间隔:"},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(O,{modelValue:(0,r.unref)(s).develop,"onUpdate:modelValue":t[8]||(t[8]=e=>(0,r.unref)(s).develop=e),placeholder:"分钟计算单位",style:{width:"50%","margin-right":"10px"}},null,8,["modelValue"]),(0,r.createTextVNode)("分 ")])),_:1}),(0,r.createVNode)(j,{label:"切换间隔:"},{default:(0,r.withCtx)((()=>[(0,r.createVNode)(O,{modelValue:(0,r.unref)(s).switch,"onUpdate:modelValue":t[9]||(t[9]=e=>(0,r.unref)(s).switch=e),placeholder:"分钟计算单位",style:{width:"50%","margin-right":"10px"}},null,8,["modelValue"]),(0,r.createTextVNode)("分 ")])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"]),(0,r.createVNode)(L,{modelValue:(0,r.unref)(i),"onUpdate:modelValue":t[12]||(t[12]=e=>(0,r.isRef)(i)?i.value=e:i=e),title:"工作状态",width:"20%",center:""},{default:(0,r.withCtx)((()=>[(0,r.unref)(i)?((0,r.openBlock)(),(0,r.createElementBlock)("div",k,[(0,r.createVNode)(R,{style:{width:"50%"},src:"".concat((0,r.unref)(i).image),"zoom-rate":1.2,"preview-src-list":["".concat((0,r.unref)(i).image)],"initial-index":4,fit:"cover"},null,8,["src","zoom-rate","preview-src-list"])])):(0,r.createCommentVNode)("",!0),(0,r.createElementVNode)("div",E,[(0,r.createVNode)(F,null,{default:(0,r.withCtx)((()=>[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)((0,r.unref)(i).list,((e,t)=>((0,r.openBlock)(),(0,r.createBlock)(A,{key:t,timestamp:e.time},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)((0,r.toDisplayString)(e.content),1)])),_:2},1032,["timestamp"])))),128))])),_:1})])])),_:1},8,["modelValue"])],64)}}};var _=(0,o(89).Z)(S,[["__scopeId","data-v-71d05a94"]])}}]);